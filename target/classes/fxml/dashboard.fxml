<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.text.*?>
<?import javafx.scene.shape.SVGPath?>

<BorderPane xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1" 
            fx:controller="com.library.controller.DashboardController"
            stylesheets="@../css/styles.css">
    
    <top>
        <VBox>
            <!-- Top Navigation Bar -->
            <HBox styleClass="top-bar" spacing="10" alignment="CENTER_LEFT">
                <padding>
                    <Insets top="10" right="20" bottom="10" left="20" />
                </padding>
                
                <Text styleClass="app-title" text="BIBLIOTECA" />
                
                <Region HBox.hgrow="ALWAYS" />
                
                <Text styleClass="user-display-text" text="mmd-moradi" />
                
                <Button styleClass="icon-button" onAction="#showUserProfile">
                    <graphic>
                        <SVGPath content="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z" 
                                fill="WHITE" />
                    </graphic>
                    <tooltip>
                        <Tooltip text="Meu Perfil" />
                    </tooltip>
                </Button>
                
                <Button styleClass="icon-button" onAction="#handleLogout">
                    <graphic>
                        <SVGPath content="M17,17.25V14H10V10H17V6.75L22.25,12L17,17.25M13,2A2,2 0 0,1 15,4V8H13V4H4V20H13V16H15V20A2,2 0 0,1 13,22H4A2,2 0 0,1 2,20V4A2,2 0 0,1 4,2H13Z" 
                                fill="WHITE" />
                    </graphic>
                    <tooltip>
                        <Tooltip text="Sair" />
                    </tooltip>
                </Button>
            </HBox>
            
            <!-- Menu Bar -->
            <MenuBar styleClass="custom-menu-bar">
                <menus>
                    <Menu text="Livros">
                        <items>
                            <MenuItem text="Ver Todos os Livros" onAction="#showAllBooks" />
                            <MenuItem text="Adicionar Novo Livro" onAction="#showAddBook" />
                            <MenuItem text="Pesquisar Livros" onAction="#showSearchBooks" />
                        </items>
                    </Menu>
                    <Menu text="Usuários">
                        <items>
                            <MenuItem text="Ver Todos os Usuários" onAction="#showAllUsers" />
                            <MenuItem text="Adicionar Novo Usuário" onAction="#showAddUser" />
                            <MenuItem text="Pesquisar Usuários" onAction="#showSearchUsers" />
                        </items>
                    </Menu>
                    <Menu text="Circulação">
                        <items>
                            <MenuItem text="Emprestar Livro" onAction="#showIssueBook" />
                            <MenuItem text="Devolver Livro" onAction="#showReturnBook" />
                            <MenuItem text="Empréstimos Atuais" onAction="#showCurrentBorrows" />
                        </items>
                    </Menu>
                    <Menu text="Relatórios">
                        <items>
                            <MenuItem text="Livros Atrasados" onAction="#showOverdueBooks" />
                            <MenuItem text="Livros Populares" onAction="#showPopularBooks" />
                        </items>
                    </Menu>
                    <Menu text="Ajuda">
                        <items>
                            <MenuItem text="Sobre" onAction="#showAbout" />
                        </items>
                    </Menu>
                </menus>
            </MenuBar>
        </VBox>
    </top>
    
    <center>
        <TabPane fx:id="tabPane" tabClosingPolicy="UNAVAILABLE" styleClass="custom-tab-pane">
            <Tab text="Painel">
                <ScrollPane fitToWidth="true" styleClass="dashboard-scroll">
                    <VBox spacing="20">
                        <padding>
                            <Insets top="20" right="20" bottom="20" left="20" />
                        </padding>
                        
                        <!-- Welcome Section -->
                        <HBox styleClass="welcome-section" alignment="CENTER_LEFT">
                            <VBox>
                                <Text styleClass="welcome-text" text="Bem-vindo ao Sistema de Biblioteca" />
                                <Text styleClass="welcome-subtext" fx:id="welcomeSubtext" text="Data atual: 09/06/2025" />
                            </VBox>
                        </HBox>
                        
                        <!-- Statistics Cards -->
                        <Text styleClass="section-title" text="Estatísticas da Biblioteca" />
                        
                        <HBox spacing="15" alignment="CENTER">
                            <VBox styleClass="stat-card" alignment="CENTER_LEFT">
                                <HBox alignment="CENTER_LEFT" spacing="10">
                                    <StackPane styleClass="stat-icon-container">
                                        <SVGPath content="M21,5C19.89,4.65 18.67,4.5 17.5,4.5C15.55,4.5 13.45,4.9 12,6C10.55,4.9 8.45,4.5 6.5,4.5C4.55,4.5 2.45,4.9 1,6V20.65C1,20.9 1.25,21.15 1.5,21.15C1.6,21.15 1.65,21.1 1.75,21.1C3.1,20.45 5.05,20 6.5,20C8.45,20 10.55,20.4 12,21.5C13.35,20.65 15.8,20 17.5,20C19.15,20 20.85,20.3 22.25,21.05C22.35,21.1 22.4,21.1 22.5,21.1C22.75,21.1 23,20.85 23,20.6V6C22.4,5.55 21.75,5.25 21,5M21,18.5C19.9,18.15 18.7,18 17.5,18C15.8,18 13.35,18.65 12,19.5V8C13.35,7.15 15.8,6.5 17.5,6.5C18.7,6.5 19.9,6.65 21,7V18.5Z" 
                                                  fill="WHITE" />
                                    </StackPane>
                                    <VBox>
                                        <Text styleClass="stat-title" text="Total de Livros" />
                                        <Text styleClass="stat-value" fx:id="totalBooksLabel" text="153" />
                                    </VBox>
                                </HBox>
                            </VBox>
                            
                            <VBox styleClass="stat-card" alignment="CENTER_LEFT">
                                <HBox alignment="CENTER_LEFT" spacing="10">
                                    <StackPane styleClass="stat-icon-container" style="-fx-background-color: #26A69A;">
                                        <SVGPath content="M12,11.5A2.5,2.5 0 0,1 9.5,9A2.5,2.5 0 0,1 12,6.5A2.5,2.5 0 0,1 14.5,9A2.5,2.5 0 0,1 12,11.5M12,2A7,7 0 0,0 5,9C5,14.25 12,22 12,22C12,22 19,14.25 19,9A7,7 0 0,0 12,2Z" 
                                                  fill="WHITE" />
                                    </StackPane>
                                    <VBox>
                                        <Text styleClass="stat-title" text="Livros Emprestados" />
                                        <Text styleClass="stat-value" fx:id="borrowedBooksLabel" text="42" />
                                    </VBox>
                                </HBox>
                            </VBox>
                            
                            <VBox styleClass="stat-card" alignment="CENTER_LEFT">
                                <HBox alignment="CENTER_LEFT" spacing="10">
                                    <StackPane styleClass="stat-icon-container" style="-fx-background-color: #7E57C2;">
                                        <SVGPath content="M16 17V19H2V17S2 13 9 13 16 17 16 17M12.5 7.5A3.5 3.5 0 1 0 9 11A3.5 3.5 0 0 0 12.5 7.5M15.94 13A5.32 5.32 0 0 1 18 17V19H22V17S22 13.37 15.94 13M15 4A3.39 3.39 0 0 0 13.07 4.59A5 5 0 0 1 13.07 10.41A3.39 3.39 0 0 0 15 11A3.5 3.5 0 0 0 15 4Z" 
                                                  fill="WHITE" />
                                    </StackPane>
                                    <VBox>
                                        <Text styleClass="stat-title" text="Total de Usuários" />
                                        <Text styleClass="stat-value" fx:id="totalUsersLabel" text="78" />
                                    </VBox>
                                </HBox>
                            </VBox>
                            
                            <VBox styleClass="stat-card" alignment="CENTER_LEFT">
                                <HBox alignment="CENTER_LEFT" spacing="10">
                                    <StackPane styleClass="stat-icon-container" style="-fx-background-color: #EF5350;">
                                        <SVGPath content="M12,20A7,7 0 0,1 5,13A7,7 0 0,1 12,6A7,7 0 0,1 19,13A7,7 0 0,1 12,20M12,4A9,9 0 0,0 3,13A9,9 0 0,0 12,22A9,9 0 0,0 21,13A9,9 0 0,0 12,4M12.5,8H11V14L15.75,16.85L16.5,15.62L12.5,13.25V8Z" 
                                                  fill="WHITE" />
                                    </StackPane>
                                    <VBox>
                                        <Text styleClass="stat-title" text="Livros Atrasados" />
                                        <Text styleClass="stat-value" fx:id="overdueBooksLabel" text="5" />
                                    </VBox>
                                </HBox>
                            </VBox>
                        </HBox>
                        
                        <!-- Quick Actions Section -->
                        <Text styleClass="section-title" text="Ações Rápidas" />
                        
                        <HBox spacing="10" alignment="CENTER">
                            <Button styleClass="action-button" onAction="#showIssueBook">
                                <graphic>
                                    <VBox alignment="CENTER" spacing="5">
                                        <SVGPath content="M14,17H7V15H14M17,13H7V11H17M17,9H7V7H17M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3Z" 
                                                fill="WHITE" styleClass="action-icon" />
                                        <Text text="Emprestar Livro" />
                                    </VBox>
                                </graphic>
                            </Button>
                            
                            <Button styleClass="action-button" onAction="#showReturnBook">
                                <graphic>
                                    <VBox alignment="CENTER" spacing="5">
                                        <SVGPath content="M19,3H14.82C14.4,1.84 13.3,1 12,1C10.7,1 9.6,1.84 9.18,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M12,3A1,1 0 0,1 13,4A1,1 0 0,1 12,5A1,1 0 0,1 11,4A1,1 0 0,1 12,3M7,7H17V5H19V19H5V5H7V7Z" 
                                                fill="WHITE" styleClass="action-icon" />
                                        <Text text="Devolver Livro" />
                                    </VBox>
                                </graphic>
                            </Button>
                            
                            <Button styleClass="action-button" onAction="#showAddBook">
                                <graphic>
                                    <VBox alignment="CENTER" spacing="5">
                                        <SVGPath content="M18,22A2,2 0 0,0 20,20V4C20,2.89 19.1,2 18,2H12V9L9.5,7.5L7,9V2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18M14,20H6V16H14V20M14,14H6V10H14V14M14,8H6V4H14V8M16,20V4H18V20H16Z" 
                                                fill="WHITE" styleClass="action-icon" />
                                        <Text text="Adicionar Livro" />
                                    </VBox>
                                </graphic>
                            </Button>
                            
                            <Button styleClass="action-button" onAction="#showAddUser">
                                <graphic>
                                    <VBox alignment="CENTER" spacing="5">
                                        <SVGPath content="M15,4A4,4 0 0,0 11,8A4,4 0 0,0 15,12A4,4 0 0,0 19,8A4,4 0 0,0 15,4M15,5.9C16.16,5.9 17.1,6.84 17.1,8C17.1,9.16 16.16,10.1 15,10.1A2.1,2.1 0 0,1 12.9,8A2.1,2.1 0 0,1 15,5.9M4,7V10H1V12H4V15H6V12H9V10H6V7H4M15,13C12.33,13 7,14.33 7,17V20H23V17C23,14.33 17.67,13 15,13M15,14.9C17.97,14.9 21.1,16.36 21.1,17V18.1H8.9V17C8.9,16.36 12,14.9 15,14.9Z" 
                                                fill="WHITE" styleClass="action-icon" />
                                        <Text text="Adicionar Usuário" />
                                    </VBox>
                                </graphic>
                            </Button>
                            
                            <Button styleClass="action-button" onAction="#showAllBooks">
                                <graphic>
                                    <VBox alignment="CENTER" spacing="5">
                                        <SVGPath content="M19,2L14,6.5V17.5L19,13V2M6.5,5C4.55,5 2.45,5.4 1,6.5V21.16C1,21.41 1.25,21.66 1.5,21.66C1.6,21.66 1.65,21.59 1.75,21.59C3.1,20.94 5.05,20.5 6.5,20.5C8.45,20.5 10.55,20.9 12,22C13.35,21.15 15.8,20.5 17.5,20.5C19.15,20.5 20.85,20.81 22.25,21.56C22.35,21.61 22.4,21.59 22.5,21.59C22.75,21.59 23,21.34 23,21.09V6.5C22.4,6.05 21.75,5.75 21,5.5V19C19.9,18.65 18.7,18.5 17.5,18.5C15.8,18.5 13.35,19.15 12,20V6.5C10.55,5.4 8.45,5 6.5,5Z" 
                                                fill="WHITE" styleClass="action-icon" />
                                        <Text text="Listar Livros" />
                                    </VBox>
                                </graphic>
                            </Button>
                        </HBox>
                        
                        <!-- Recent Activities Table -->
                        <Text styleClass="section-title" text="Atividades Recentes" />
                        
                        <VBox styleClass="activity-container">
                            <TableView fx:id="recentActivitiesTable" styleClass="modern-table">
                                <columns>
                                    <TableColumn text="Data" fx:id="dateColumn" prefWidth="150" />
                                    <TableColumn text="Ação" fx:id="actionColumn" prefWidth="150" />
                                    <TableColumn text="Detalhes" fx:id="detailsColumn" prefWidth="350" />
                                    <TableColumn text="Usuário" fx:id="userColumn" prefWidth="150" />
                                </columns>
                                <placeholder>
                                    <Label text="Nenhuma atividade registrada no sistema" styleClass="empty-table-placeholder" />
                                </placeholder>
                            </TableView>
                        </VBox>
                    </VBox>
                </ScrollPane>
            </Tab>
        </TabPane>
    </center>
    
    <bottom>
        <HBox alignment="CENTER_LEFT" spacing="10" styleClass="status-bar">
            <padding>
                <Insets top="5" right="10" bottom="5" left="10" />
            </padding>
            <Text styleClass="status-user-text" text="Logado como:" />
            <Text styleClass="status-user-value" fx:id="currentUserLabel" text="mmd-moradi" />
            <Region HBox.hgrow="ALWAYS" />
            <Text styleClass="status-message" fx:id="statusLabel" text="Pronto" />
        </HBox>
    </bottom>
</BorderPane>